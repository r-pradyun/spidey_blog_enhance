---
import { getCollection } from "astro:content";
import PageLayout from "@layouts/PageLayout.astro";
import ArrowCard from "@components/ArrowCard";
import StackCard from "@components/StackCard.astro";
import { SITE, SOCIALS } from "@consts";
import TwinklingStars from "@components/TwinklingStars.astro";
import MeteorShower from "@components/MeteorShower.astro";

const posts = (await getCollection("blog"))
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 3);

const projects = (await getCollection("projects"))
  .filter(project => !project.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 3);

const stack = [
  { text: "Astro", icon: "astro", href: "https://astro.build" },
  { text: "javaScript", icon: "javascript", href: "https://www.javascript.com" },
  { text: "TypeScript", icon: "typescript", href: "https://www.typescriptlang.org" },
  { text: "Tailwind CSS", icon: "tailwind", href: "https://tailwindcss.com" }
];
---

<PageLayout title="Home" description={SITE.DESCRIPTION}>

  <!-- Background Visuals -->
  <div class="absolute inset-0">
    <!-- Light Theme Particles -->
    <div class="block dark:hidden">
      <div id="particles1" class="fixed inset-0"></div>
      <div id="particles2" class="fixed inset-0"></div>
      <div id="particles3" class="fixed inset-0"></div>
    </div>

    <!-- Dark Theme Stars & Effects -->
    <div class="hidden dark:block bg-black fixed inset-0">
      <div id="stars1" class="fixed inset-0"></div>
      <div id="stars2" class="fixed inset-0"></div>
      <div id="stars3" class="fixed inset-0"></div>
      <div id="galaxy" class="fixed inset-0">
        <TwinklingStars />
        <MeteorShower />
      </div>
    </div>
  </div>

  <script is:inline src="/js/bg.js"></script>

  <!-- HERO Section -->
  <section class="relative h-screen flex items-center justify-center">
    <div class="text-center p-5 z-10">
      <p class="text-lg md:text-xl font-semibold opacity-75">
        Hello, I'm
      </p>
      <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold uppercase text-black dark:text-white">
        Pradyun
      </h1>
      <p class="text-base md:text-lg opacity-75 mt-2">
        Breaking things to learn, hack, and stay ahead of patches
      </p>
      <div class="mt-6 flex flex-wrap justify-center gap-4">
        <a href="/blog" class="py-2 px-4 rounded text-sm md:text-base bg-black text-white dark:bg-white dark:text-black hover:opacity-80 transition">
          Read My Blog
        </a>
        <a href="/Pradyun_R.pdf" target="_blank" class="py-2 px-4 rounded text-sm md:text-base border border-black/30 dark:border-white/30 hover:bg-black/10 dark:hover:bg-white/10 transition">
          My Resume
        </a>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <div class="relative bg-white dark:bg-black">
    <div class="mx-auto max-w-screen-sm p-6 space-y-24 pb-20">

      <!-- About Section -->
      <section class="space-y-4">
        <h2 class="text-xl font-semibold text-black dark:text-white">About Me</h2>
        <p>I’m a <strong>cybersecurity enthusiast</strong> focused on <strong>web and Mobile security</strong>.</p>
        <p>I explore systems by breaking them down uncovering logic flaws, bypassing constraints, and solving security puzzles.</p>
        <p><strong>What I do:</strong> I hack, analyze, and secure—from web exploits to Mobile investigations always seeking creative, effective solutions.</p>
<p><strong>What I’ve done:</strong> Broken into web and Android apps by exploiting auth flaws, IPC bugs, and pulling sensitive data with Frida and custom hooks.</p>
        <p><strong>Currently:</strong> I’m sharpening my skills, contributing to the infosec community, and solving increasingly advanced CTF challenges.</p>
      </section>

      <!-- Blog Section -->
      <section class="space-y-4">
        <div class="flex justify-between items-center">
          <h2 class="text-xl font-semibold text-black dark:text-white">Recent Posts</h2>
          <a href="/blog" class="text-sm underline hover:opacity-80 text-black dark:text-white">
            View All
          </a>
        </div>
        <ul class="space-y-4">
          {posts.map(post => (
            <li><ArrowCard entry={post} /></li>
          ))}
        </ul>
      </section>

      <!-- Contact Section -->
      <section class="space-y-4">
        <h2 class="text-xl font-semibold text-black dark:text-white">Let's Connect</h2>
        <p>You can reach out via email or any of the platforms below.</p>
        <div class="grid grid-cols-4 gap-y-3">
          {SOCIALS.map(social => (
            <>
              <div class="col-span-1 truncate">{social.NAME}</div>
              <div class="col-span-3 truncate">
                <a href={social.HREF} target="_blank" class="underline hover:opacity-80 text-black dark:text-white">
                  {social.TEXT}
                </a>
              </div>
            </>
          ))}
        </div>
      </section>

    </div>
  </div>
</PageLayout>
